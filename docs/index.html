<html>
  <head>
    <title>PlugDOS-TS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.js" integrity="sha512-2PRgAav8Os8vLcOAh1gSaDoNLe1fAyq8/G3QSdyjFFD+OqNjLeHE/8q4+S4MEZgPsuo+itHopj+hJvqS8XUQ8A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typescript/4.4.4/typescript.min.js" integrity="sha512-v+nqpsqV4CqtMyv/VkhE3OHwuHdM0q28wM4rnwUkqgCKD5ma7aI6PQDs97MBUS8a2Iaph6knAQ+rCWgJAB4L4g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.css" integrity="sha512-iLYuqv+v/P4u9erpk+KM83Ioe/l7SEmr7wB6g+Kg1qmEit8EShDKnKtLHlv2QXUp7GGJhmqDI+1PhJYLTsfb8w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>
  
  <body>
    <div id="terminal" style="width: 100%; height: 100%; margin: 0;"></div>
    
    <script>
      var term = new Terminal();
      term.open(document.querySelector('#terminal'))
      let isInputted = false;
      let finalData = "";
      
      function dataChecker(data) {
        if(isInputted) {
          setTimeout(() => { dataChecker(data) }, 100)
        } else {
          isInputted = true;
          finalData = data;
        }
      }
      
      term.on(dataChecker)
      
      function stdout(output) {
        term.writeln(output);
      }
      
      function stdin(input, callback) {
        if(isInputted) {
            isInputted = false;
            return callback(finalData);
        } else {
            setTimeout(function(){ stdin(input, callback); }, 100)
        }
      }
      
      function stdclear() {
        term.clear();
      }
      
      setTimeout(function(){
        let dos = new PlugDOS();
        dos.Boot();
      }, 1000)
    </script>
    <script src="./PlugDOS.js"></script>
  </body>
</html>
